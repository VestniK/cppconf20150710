# Диспетчеризация вызово посредством C++11 variadic templates

Двнный пример демонстрирует как можно простым и компактным кодом, без использования
внешних кодогенераторов вызывать C++ функции из интерпретатора командной строки.

Пример работы программы:

```
[vestnik@VestniK-laptop build]$ ./bin/cli 
list
Available functions:
 * add
 * containsBar
 * containsFoo
 * div
 * list
 * mod
 * mul
 * set
 * sub
add 1546 4747
6293
set QWE 16354
OK
div ${QWE} 23
711
div ewrhg 65
Error: T Context::parse(const std::string &) [T = int]: Failed to parse argument 'ewrhg'
containsFoo ${QWE}
false
containsFoo nofoobar
true
```
   
Движок обработчика командной строки занимает чуть больше полсотни строк и позволяет просовывать в скрипт произвольную функцию или константный метод объекта произвольного типа. В сигнатуре регистрируемой функции могут использоваться любые типы для которых определены операторы извлечения и вставки в поток. Вывод типа регистрируемой функции производится компилятором и не требует дополнительных действий.

## Путеводитель по файлам

 * main.cpp - Собственно пример использования
 * commandrunner.h - Класс вызывающий обработчик для введённой команды
 * handler.h - Адапторы конвертирующие типизированные функции C++ в функторы с сигнатурой `std::string(std::vector<std::string>)`
 * formatutils.h - Пользовательский литерал вокруг `snprintf` упрощающий конструирование строк. Пример использования: `"Hello %s you are number %d in line"_fmt("Vasya", 13)`
 * cpputils.h - Реализации C++14 `std::experimental` функций и структур которые используются в коде (теоретически проект должен собираться компилятором удовлетворяющим стандарту C++11 и не знающим ничего про C++14, но это не проверялось)

## Ограничения

Из за баги в gcc этот код получается собрать только clang'ом. В багтрекере gcc утверждается что баг исправлен в gcc 4.9.1, но по факту 4.9.2 и 5.1.0 выдали те же проблемы с порядком выполнения выражений внутри Universal initalizer'а. У студии 2013 с универсальной инициализацией вообще было плохо. Не знаю как с ним обстоят дела в 2015. Возможно она соберёт и всё будет работать.
